#################################################
# NOTES: This script was run on an interactive node from the outputs from Step8.2.7 to filter and produce the 2x intraspecific PCA (Fig. 2f) of the associated study.
#################################################


#Plink1.9 filtering
module load plink/1.90b7.7
plink --tfile triton2x_2n --make-bed --allow-extra-chr --missing --recode --out triton2x_2n #SNPs 7,785
plink --bfile triton2x_2n --allow-extra-chr --indep-pairwise 50 5 0.2 --out triton2x_2n
plink --bfile triton2x_2n --allow-extra-chr --extract triton2x_2n.prune.in --make-bed --distance triangle ibs 1-ibs allele-ct --out triton2x_2n_ldprune_PCA #SNPs 4,080

#PCA construction
module load plink
plink2 --bfile triton2x_2n_ldprune_PCA --pca 10 --allow-extra-chr --bad-freqs --out triton2x_2n_ldprune_PCA #SNPs 4,080
